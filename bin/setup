# Install rbenv:

echo "Installing rbenv..."
git clone https://github.com/sstephenson/rbenv.git $RBENV_ROOT
echo "Done."

# Install plugins:
PLUGINS=(
  sstephenson/ruby-build
)

echo "Installing plugins..."
for plugin in ${PLUGINS[@]} ; do

  KEY=${plugin%%/*}
  VALUE=${plugin#*/}

  RBENV_PLUGIN_ROOT="${RBENV_ROOT}/plugins/$VALUE"
  if [ ! -d "$RBENV_PLUGIN_ROOT" ] ; then
    git clone https://github.com/$KEY/$VALUE.git $RBENV_PLUGIN_ROOT
  else
    cd $RBENV_PLUGIN_ROOT
    echo "Pulling $VALUE updates."
    git pull
  fi

done
echo "Done."

echo "gem: --no-rdoc --no-ri" > ${OPENSHIFT_DATA_DIR}.gemrc

echo '
if [ -d "${RBENV_ROOT}" ]; then
  eval "$(rbenv init -)"
fi

alias gem="gem --config-file ${OPENSHIFT_DATA_DIR}.gemrc"
' > $RBENV_INIT

echo 'source $RBENV_INIT' >> ~/.bash_profile

echo "Installing Riemann..."

wget http://aphyr.com/riemann/riemann-0.2.6.tar.bz2
tar xvfj riemann-0.2.6.tar.bz2
mv riemann-0.2.6 riemann

echo "Done".
